@using Umbraco.Cms.Web.Common.PublishedModels;
@inherits Umbraco.Cms.Web.Common.Views.UmbracoViewPage
@using System.Linq

@{
	Layout = "master.cshtml";
}


<link rel="stylesheet" href="/css/ArchivesPageStyle.css"/>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css" />


@using Umbraco.Cms.Core.Models.Blocks

@{
    var programsItems = Model.Value<IEnumerable<BlockListItem>>("programsItems");

    var firstTwoItems = programsItems?.Take(2).ToList() ?? new List<BlockListItem>();
    var nextThreeItems = programsItems?.Skip(2).Take(3).ToList() ?? new List<BlockListItem>();

}

<h1 class="text-center">ארכיון גל"צ</h1>

  <div class="container">

    <!-- שורה ראשונה: שני מלבנים גדולים -->
    <div class="grid row1">
    @foreach (var item in firstTwoItems)
    {
        var programItem = item.Content.Value<IPublishedContent>("programItem");
        var image = programItem?.Value<IPublishedContent>("squareImage");

        if (programItem != null && image != null)
        {
            <a href="@programItem.Url()" class="card">
                <div class="card large">
                    <img src="@image.Url()" alt="img">
                 </div>
            </a>
        }
    }
    </div>
    

    <!-- שורה שנייה: שלושה מלבנים קטנים -->
    <div class="grid row2">
      @foreach (var item in nextThreeItems)
      {
        var programItem = item.Content.Value<IPublishedContent>("programItem");
        var image = programItem?.Value<IPublishedContent>("squareImage");

        if (programItem != null && image != null)
          {
            <a href="@programItem.Url()" class="card">
                <div class="card small">
                    <img src="@image.Url()" alt="img">
                </div>
            </a>
            }
     }  

    </div>
</div>




<h1 class="text-right" style="margin-right:45px;">גל"צ מרתונים</h1>

@using Umbraco.Cms.Core.Models.Blocks
@using Umbraco.Cms.Core.Models.PublishedContent

@{
    var programsMarthon = Model.Value<IEnumerable<BlockListItem>>("marthonItems");
}

<style>
    .swiper {
    position: relative;
    padding: 20px 60px; /* רווח לוחצים מצדדים */
    height: 300px; /* קבע גובה שיתאים לגובה התמונה + הכותרת */
    width: 100%;   /* חובה כדי לחשב כמה שקפים נכנסים */
    margin-bottom: 30px;
}

.swiper-button-prev,
.swiper-button-next {
    position: absolute;
    top: 60%;
    transform: translateY(-50%);
    width: 40px;
    height: 40px;
    background-color: rgba(0, 0, 0, 0.15);
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    transition: background-color 0.3s ease, transform 0.2s ease;
    user-select: none;
    z-index: 9999; /* לוודא שהחיצים תמיד מעל התמונות */
}

.swiper-button-prev:hover,
.swiper-button-next:hover {
    background-color: rgba(0, 0, 0, 0.35);
    transform: translateY(-50%) scale(1.15);
}

.swiper-button-prev,
.swiper-button-next {
    background-color: rgba(0,0,0,0.25);
    border-radius: 50%;
    width: 40px;
    height: 40px;
}
.swiper-button-prev::after,
.swiper-button-next::after {
    font-size: 18px;
    color: #fff;
}

    .swiper-slide a {
        display: block;
        border-radius: 6px;
        overflow: hidden; 
        cursor: pointer;
        text-decoration: none;
        color: inherit;
        user-select: none;
    }

    .swiper-slide {
    height: auto !important;
    display: flex;
    flex-direction: column;
    align-items: center;
    flex-shrink: 0; /* שלא יתכווץ */
}

.swiper-slide img {
    width: 100%;
    height: 250px;
    object-fit: cover;
    border-radius: 12px;
    box-shadow: 0 12px 12px rgba(0, 0, 0, 0.08);
}

    .swiper-slide h3 {
        margin-top: 8px;
        text-align: center;
        font-size: 20px;
        color: #222;
        user-select: none;
    }
</style>

<div class="swiper mySwiper" dir="rtl">
    <div class="swiper-wrapper">
        @if (programsMarthon != null && programsMarthon.Any())
        {
            foreach (var program in programsMarthon)
            {
                var item = program.Content;
                var programItem = item.Value<IPublishedContent>("programItem");

                if (programItem != null && programItem.HasValue("squareImage"))
                {
                    var image = programItem.Value<IPublishedContent>("squareImage");
                    <div class="swiper-slide">
                        <a href="@programItem.Url()" title="@programItem.Name()">
                            <img src="@image.Url()" alt="@programItem.Name()" />
                            <h3>@programItem.Name()</h3>
                        </a>
                    </div>
                }
            }
        }
    </div>

    <!-- החיצים -->
    <div class="swiper-button-next"></div>
    <div class="swiper-button-prev"></div>
</div>

<script>
    const swiper = new Swiper(".mySwiper", {
        slidesPerView: 5,
    spaceBetween: 20, // מרווח בין שקפים
        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
        },
        loop: false,
        // אל תשים rtl:true – זה מתנגש עם dir="rtl"
    });
</script>

